<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>تطبيق رقة - عالمك الخاص</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Aref+Ruqaa:wght@700&family=Tajawal:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* تعريف المتغيرات (Colors & Dimensions) */
        :root {
            --primary-pink: #e91e63;
            --soft-pink: #fce4ec;
            --gold: #d4af37;
            --text-main: #4a4a4a;
            --white: #ffffff;
            --nav-height: 70px; /* ارتفاع شريط التنقل السفلي */
            --accent-green: #4CAF50;
            --accent-blue: #2196F3;
            --accent-red: #f44336;
        }

        /* تنسيق الجسم الأساسي */
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #faf9f9;
            margin: 0;
            padding: 0;
            /* إضافة حشو أسفل الصفحة لتجنب تداخل المحتوى مع شريط التنقل */
            padding-bottom: calc(var(--nav-height) + 15px); 
            color: var(--text-main);
            overflow-x: hidden;
        }

        /* --- الهيدر (Header) --- */
        header {
            background: var(--white);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 15px rgba(233, 30, 99, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .app-logo {
            font-family: 'Aref Ruqaa', serif;
            font-size: 2.4rem;
            color: var(--primary-pink);
            text-shadow: 2px 2px 0px #ffe0e9;
        }

        /* زر الأدمن (قلب نابض) */
        .admin-btn {
            background: var(--primary-pink);
            border: none;
            color: var(--white);
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 10px rgba(233, 30, 99, 0.5);
            position: relative;
        }
        
        .admin-btn i {
            font-size: 1.5rem;
        }

        .admin-btn:hover { 
            background: #c2185b;
            box-shadow: 0 6px 15px rgba(233, 30, 99, 0.7);
        }
        
        .admin-btn i.fa-heart-pulse {
            animation: heartBeat 1.5s infinite alternate;
            color: var(--white);
        }

        @keyframes heartBeat {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* --- شريط التنقل السفلي (Bottom Navigation) --- */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--nav-height);
            background: var(--white);
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 2000;
        }

        .nav-item {
            text-decoration: none;
            color: #888;
            flex-grow: 1;
            text-align: center;
            padding: 5px 0;
            transition: color 0.3s, transform 0.3s;
            font-size: 0.75rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            cursor: pointer;
        }

        .nav-item i {
            font-size: 1.4rem;
            margin-bottom: 2px;
        }

        .nav-item.active {
            color: var(--primary-pink);
            transform: scale(1.1);
        }

        .nav-item:hover {
            color: var(--primary-pink);
        }

        /* تنسيقات الأقسام */
        .nav-item[data-section="fiqh"] i { color: #00bcd4; }
        .nav-item[data-section="intimacy-new"] i { color: #f44336; }
        .nav-item[data-section="health"] i { color: #2196F3; }
        .nav-item[data-section="society-new"] i { color: #d4af37; }
        .nav-item[data-section="feelings"] i { color: var(--primary-pink); }
        .nav-item[data-section="home"] i { color: #4a4a4a; }

        .main-container { padding: 20px; }

        /* --- شريط البحث الجديد --- */
        .search-container {
            position: relative;
            margin-bottom: 20px;
            animation: fadeIn 0.5s;
        }
        .search-input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border-radius: 25px;
            border: 1px solid #ddd;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            outline: none;
            transition: 0.3s;
        }
        .search-input:focus {
            border-color: var(--primary-pink);
            box-shadow: 0 4px 10px rgba(233, 30, 99, 0.1);
        }
        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-pink);
        }

        /* --- الترحيب والأقسام --- */
        .welcome-section {
            text-align: center;
            background: linear-gradient(135deg, #fff 0%, #fff0f6 100%);
            padding: 40px 20px;
            border-radius: 25px;
            border: 1px solid #ffeef2;
            margin-bottom: 20px;
            animation: fadeIn 0.5s;
        }
        .welcome-section h2 {
            font-family: 'Aref Ruqaa', serif;
            color: var(--primary-pink);
            font-size: 2rem;
            margin: 0 0 15px 0;
        }
        .welcome-section p {
            font-size: 1.1rem;
            color: #666;
            line-height: 1.8;
        }

        .section-view {
            display: none;
            animation: slideUp 0.4s ease-out;
        }
        #homeView { display: block; }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            border-top: 4px solid var(--primary-pink);
            transition: box-shadow 0.3s;
            position: relative;
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--primary-pink);
            font-family: 'Aref Ruqaa', serif;
            font-size: 1.4rem;
        }
        
        /* تلوين الأقسام */
        #sec-intimacy-new .card-header { color: var(--accent-red); }
        #sec-intimacy-new .card { border-top-color: var(--accent-red); }
        #sec-society-new .card-header { color: var(--gold); }
        #sec-society-new .card { border-top-color: var(--gold); }
        #sec-health .card-header { color: var(--accent-blue); }
        #sec-health .card { border-top-color: var(--accent-blue); }
        #sec-fiqh .card-header { color: #00bcd4; }
        #sec-fiqh .card { border-top-color: #00bcd4; }
        
        .bouh-display {
            background: #fffdfd;
            border: 1px dashed #f48fb1;
            padding: 20px;
            border-radius: 15px;
            min-height: 80px;
            margin-bottom: 20px;
            position: relative;
            font-size: 1rem;
            line-height: 1.7;
            color: #555;
            white-space: pre-wrap;
            cursor: pointer;
        }
        .bouh-display::before {
            content: "✨ همسة الأسبوع";
            position: absolute;
            top: -12px; right: 15px;
            background: var(--primary-pink);
            color: white;
            font-size: 0.7rem;
            padding: 4px 12px;
            border-radius: 20px;
            cursor: default;
        }
        
        .sequential-content-container {
            margin-top: 20px;
            padding: 15px;
            background: #f7f7f7;
            border-radius: 15px;
            border: 1px solid #eee;
        }
        .content-item-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-right: 4px solid var(--accent-green);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            position: relative;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        .content-item-card .type-badge {
            display: inline-block;
            background: #e0f7fa;
            color: #00bcd4;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .content-item-card .post-content {
            margin-bottom: 10px;
            color: #333;
        }
        .content-item-card small {
            display: block;
            color: #999;
            font-size: 0.75rem;
            text-align: left;
        }

        .newly-added {
            border: 2px solid var(--accent-green) !important;
            background-color: #e8f5e9 !important;
            animation: highlightPulse 2s infinite;
        }
        
        /* تنسيق زر الحذف عند تفعيل وضع الحذف */
        .delete-overlay-btn {
            display: none;
            position: absolute;
            top: -12px;
            left: -12px;
            width: 35px;
            height: 35px;
            background: #ff1744;
            color: white;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            z-index: 999;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            animation: popIn 0.3s ease-out;
        }
        
        body.delete-mode-active .delete-overlay-btn {
            display: flex; /* إظهار زر الحذف عند تفعيل وضع الحذف */
        }
        
        body.delete-mode-active .card, 
        body.delete-mode-active .bouh-display,
        body.delete-mode-active .content-item-card {
            border: 2px dashed #ff1744 !important; /* تمييز المحتوى القابل للحذف */
            cursor: not-allowed;
        }
        
        .delete-mode-active .card:hover, .delete-mode-active .content-item-card:hover {
            box-shadow: 0 0 10px #ff1744 !important;
        }
        
        /* باقي الستايلات الخاصة بالتتبعات والصيغ الأخرى تم الحفاظ عليها كما هي لضمان عدم تغيير النمط */
        .health-subs {
            display: flex;
            justify-content: space-around;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .h-link {
            text-align: center;
            font-size: 0.8rem;
            color: var(--primary-pink);
            background: var(--soft-pink);
            padding: 10px 5px;
            border-radius: 12px;
            width: 30%;
            text-decoration: none;
            transition: 0.3s;
            font-weight: bold;
            margin-bottom: 10px;
            border: 1px solid transparent;
            cursor: pointer;
            box-sizing: border-box;
        }
        .h-link:hover {
            background: var(--primary-pink);
            color: var(--white);
            box-shadow: 0 4px 8px rgba(233, 30, 99, 0.3);
        }
        .h-link.activity-h-link {
            width: 30%; 
            background: #e3f2fd;
            color: var(--accent-blue);
            border: 1px solid var(--accent-blue);
        }
        .h-link.pregnancy-tracker {
            background: #f3e5f5;
            color: #7b1fa2;
            border: 1px solid #ab47bc;
        }
        .h-link.cycle-tracker {
             background: #ffe0e9;
             color: #c2185b;
             border: 1px solid #e91e63;
        }
        .h-link.nursing-tracker {
            background: #e8f5e9;
            color: var(--accent-green);
            border: 1px solid var(--accent-green);
        }
        .h-link.skin-care-tracker {
            background: #fce4ec;
            color: #ff80ab;
            border: 1px solid #ff80ab;
        }
        .tracker-ui {
            display: none;
            background: #fdfdfd;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #eee;
            margin-top: 15px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.02);
            font-size: 0.95rem;
        }
        .tracker-result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            background: #e8f5e9;
            color: var(--accent-green);
            font-weight: bold;
            text-align: center;
        }
        .tracker-form input, .tracker-form select, .tracker-form textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1rem;
            margin-top: 5px;
            font-family: 'Tajawal', sans-serif;
            resize: vertical;
        }
        .tracker-form button {
            width: 100%;
            background: var(--primary-pink);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: 0.3s;
        }
        .admin-panel { 
            display: none; 
            background: white; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 15px; 
            border: 2px dashed var(--primary-pink); 
        }
        .inp-field {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
        }
        .btn-primary {
            width: 100%;
            background: var(--primary-pink);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: 0.3s;
        }
        .upload-grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 10px; 
            margin-top: 15px; 
            margin-bottom: 25px; 
        }
        .up-btn {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #eee;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            transition: all 0.2s ease-in-out;
        }
        .up-btn i { font-size: 1.2rem; margin-bottom: 5px; display: block; color: #666; }
        .up-btn.post-btn { background: var(--soft-pink); color: var(--primary-pink); border-color: var(--primary-pink); }
        .modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }
        .modal-box {
            background: white;
            padding: 25px;
            border-radius: 15px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            animation: popIn 0.3s;
        }
    </style>
</head>
<body>

    <header>
        <div class="app-logo">رقة</div>
        <button class="admin-btn" id="adminToggleBtn" onclick="toggleAdminPanel()"><i class="fas fa-heart-pulse"></i></button>
    </header>

    <div class="main-container">
        
        <div class="search-container">
            <input type="text" id="searchInput" class="search-input" oninput="filterContent(this.value)" placeholder="ابحث عن محتوى أو تتبع صحي...">
            <i class="fas fa-search search-icon"></i>
        </div>

        <div id="adminLogin" class="admin-panel" style="display: none; border-color: #673ab7;">
            <h3 style="color: #673ab7;"><i class="fas fa-key"></i> تسجيل دخول المشرف</h3>
            <form onsubmit="adminLogin(event)">
                <input type="text" id="adminUsername" class="inp-field" placeholder="اسم المستخدم" required>
                <input type="password" id="adminPassword" class="inp-field" placeholder="كلمة المرور" required>
                <button type="submit" class="btn-primary" style="background:#673ab7;"><i class="fas fa-sign-in-alt"></i> دخول</button>
            </form>
        </div>
        
        <div id="adminDashboard" class="admin-panel" style="display: none; border-color: var(--accent-green);">
            <h3 style="color: var(--accent-green);"><i class="fas fa-user-shield"></i> لوحة تحكم الأدمن</h3>
            
            <label for="adminSectionSelect" style="display: block; margin-bottom: 10px; font-weight: bold;">اختر القسم لرفع المحتوى:</label>
            <select id="adminSectionSelect" class="inp-field" required>
                <option value="sec-feelings">1. المشاعر</option>
                <option value="sec-fiqh">2. الفقة</option>
                <option value="sec-intimacy-new">3. الحميمية</option>
                <option value="sec-health">4. الصحة والجمال</option>
                <option value="sec-society-new">5. المجتمع</option>
            </select>
            
            <div class="upload-grid">
                <div class="up-btn post-btn" onclick="openUploadPostModal('بوست/منشور')">
                    <i class="fas fa-feather-alt"></i> نشر بوست
                </div>
                <div class="up-btn post-btn" onclick="openUploadPostModal('فكرة')">
                    <i class="fas fa-lightbulb"></i> نشر فكرة
                </div>
                <div class="up-btn post-btn" onclick="openUploadPostModal('نصيحة')">
                    <i class="fas fa-star"></i> نشر نصيحة
                </div>
                <div class="up-btn post-btn" onclick="openUploadPostModal('البوح')">
                    <i class="fas fa-comment-dots"></i> تحديث الهمسة الأسبوعية
                </div>
            </div>
            
            <button class="btn-primary" id="deleteModeBtn" onclick="toggleDeleteMode()" style="background:#f44336; margin-top: 5px;">
                <i class="fas fa-trash-alt"></i> تفعيل وضع الحذف
            </button>
            
            <button class="btn-primary" onclick="openModal('aiGeneratorModal')" style="background: #00bcd4; margin-top: 15px;">
                <i class="fas fa-robot"></i> توليد محتوى بالذكاء الاصطناعي
            </button>
        </div>

        <div id="homeView" class="section-view">
            <div class="welcome-section">
                <h2>مرحباً بكِ في رقة</h2>
                <p>مساحة آمنة ومخصصة لكل أنثى تبحث عن التوازن، الوعي، والرقي في حياتها. اكتشفي محتوى مصمماً لجمالك الداخلي والخارجي، وصحتك، وعلاقاتك.</p>
                <div style="margin-top: 20px;">
                    <button class="btn-primary" onclick="showSection('feelings');" style="width: 48%; display: inline-block; background: var(--primary-pink);">انطلقي الآن <i class="fas fa-arrow-left"></i></button>
                </div>
            </div>
        </div>

        <div id="sec-feelings" class="section-view">
            <div class="card" data-post-id="101" data-post-title="مساحة آمنة لقلبك">
                 <button class="delete-overlay-btn" onclick="deletePost('101', 'sec-feelings', event)"><i class="fas fa-times"></i></button>
                <div class="card-header"><i class="fas fa-heart"></i> المشاعر والتوازن النفسي</div>
                <div class="bouh-display" id="txt-feelings" onclick="openContentScreen('sec-feelings', 'همسة الأسبوع', event)">
                    مساحة آمنة لقلبك، حيث تجدين التعبير والدعم.
                    <br> <small style="color:var(--primary-pink); display:block; margin-top:5px; text-align:center; font-weight:bold;"><i class="fas fa-search"></i> انقري هنا لقراءة الهمسة الأسبوعية</small> 
                </div>
                <a href="https://ar.wikipedia.org/wiki/%D8%B9%D9%84%D9%85_%D8%A7%D9%84%D9%86%D9%81%D8%B3" target="_blank" class="library-link" title="مقالات وكتب علم النفس">المكتبة الإضافية</a>
                <div class="sequential-content-container" id="content-container-sec-feelings">
                    <p style="text-align: center; color: #999; font-size: 0.85rem; margin-bottom: 0;">جاري تحميل المحتوى من قاعدة بيانات Neon...</p>
                </div>
                <div class="interaction-bar">
                    <button class="act-btn like-btn" onclick="toggleLike(this, 101)"><i class="far fa-heart"></i> <span>إعجاب</span></button>
                    <button class="act-btn" onclick="openCommentModal(101)"><i class="far fa-comment"></i> <span>تعليق</span></button>
                    <button class="act-btn" onclick="shareContent(101, 'مساحة آمنة لقلبك..')"><i class="fas fa-share-alt"></i> <span>مشاركة</span></button>
                </div>
            </div>
        </div>

        <div id="sec-fiqh" class="section-view">
            <div class="card" data-post-id="102" data-post-title="نور البصيرة في أمور دينك">
                 <button class="delete-overlay-btn" onclick="deletePost('102', 'sec-fiqh', event)"><i class="fas fa-times"></i></button>
                <div class="card-header"><i class="fas fa-book-reader"></i> الفقة نور البصيرة</div>
                <div class="bouh-display" id="txt-fiqh" onclick="openContentScreen('sec-fiqh', 'همسة الأسبوع', event)">
                    ثبات في زمن الفتن، نصوص ودروس تفقهك في دينك وأمور حياتك.
                    <br> <small style="color:var(--primary-pink); display:block; margin-top:5px; text-align:center; font-weight:bold;"><i class="fas fa-search"></i> انقري هنا لقراءة الهمسة الأسبوعية</small> 
                </div>
                <a href="https://ar.wikipedia.org/wiki/%D9%81%D9%82%D9%87" target="_blank" class="library-link" title="مقالات وكتب فقهية">المكتبة الفقهية</a>
                <div class="sequential-content-container" id="content-container-sec-fiqh">
                    <p style="text-align: center; color: #999; font-size: 0.85rem; margin-bottom: 0;">جاري تحميل المحتوى من قاعدة بيانات Neon...</p>
                </div>
                <div class="interaction-bar">
                    <button class="act-btn like-btn" onclick="toggleLike(this, 102)"><i class="far fa-heart"></i> <span>إعجاب</span></button>
                    <button class="act-btn" onclick="openCommentModal(102)"><i class="far fa-comment"></i> <span>تعليق</span></button>
                    <button class="act-btn" onclick="shareContent(102, 'الفقه نور البصيرة')"><i class="fas fa-share-alt"></i> <span>مشاركة</span></button>
                </div>
            </div>
        </div>

        <div id="sec-intimacy-new" class="section-view">
            <div class="card" data-post-id="103" data-post-title="الحميمية والعلاقات">
                 <button class="delete-overlay-btn" onclick="deletePost('103', 'sec-intimacy-new', event)"><i class="fas fa-times"></i></button>
                <div class="card-header"><i class="fas fa-hand-holding-heart"></i> الحميمية والعلاقات</div>
                <div class="bouh-display" id="txt-intimacy-new" onclick="openContentScreen('sec-intimacy-new', 'همسة الأسبوع', event)">
                    تعميق الود، تقوية الروابط، وفهم أعمق لأساسيات العلاقة الزوجية.
                    <br> <small style="color:var(--primary-pink); display:block; margin-top:5px; text-align:center; font-weight:bold;"><i class="fas fa-search"></i> انقري هنا لقراءة الهمسة الأسبوعية</small> 
                </div>
                <a href="https://ar.wikipedia.org/wiki/%D8%B9%D9%84%D8%A7%D9%82%D8%A9_%D8%AD%D9%85%D9%8A%D9%85%D8%A9" target="_blank" class="library-link" title="مقالات وكتب عن العلاقات">مكتبة العلاقات</a>
                <div class="sequential-content-container" id="content-container-sec-intimacy-new">
                    <p style="text-align: center; color: #999; font-size: 0.85rem; margin-bottom: 0;">جاري تحميل المحتوى من قاعدة بيانات Neon...</p>
                </div>
                <div class="interaction-bar">
                    <button class="act-btn like-btn" onclick="toggleLike(this, 103)"><i class="far fa-heart"></i> <span>إعجاب</span></button>
                    <button class="act-btn" onclick="openCommentModal(103)"><i class="far fa-comment"></i> <span>تعليق</span></button>
                    <button class="act-btn" onclick="shareContent(103, 'الحميمية والعلاقات')"><i class="fas fa-share-alt"></i> <span>مشاركة</span></button>
                </div>
            </div>
        </div>
        
        <div id="sec-health" class="section-view">
            <div class="card" data-post-id="105" data-post-title="الصحة والجمال">
                 <button class="delete-overlay-btn" onclick="deletePost('105', 'sec-health', event)"><i class="fas fa-times"></i></button>
                <div class="card-header"><i class="fas fa-venus"></i> الصحة والجمال</div>
                <div class="bouh-display" id="txt-health" onclick="openContentScreen('sec-health', 'همسة الأسبوع', event)">
                    جمالك يبدأ من صحتك الداخلية. اهتمي بالتفاصيل الصغيرة لتضيئي.
                    <br> <small style="color:var(--primary-pink); display:block; margin-top:5px; text-align:center; font-weight:bold;"><i class="fas fa-search"></i> انقري هنا لقراءة الهمسة الأسبوعية</small> 
                </div>
                
                <h4 style="margin-top: 25px; color: var(--accent-blue);"><i class="fas fa-chart-line"></i> تتبعات الأنشطة والمتابعات</h4>
                <div class="health-subs">
                    <div class="h-link cycle-tracker" onclick="toggleTracker('cycleTracker', event)">متابعة الحيض</div>
                    <div class="h-link pregnancy-tracker" onclick="toggleTracker('pregnancyTracker', event)">متابعة الحمل</div>
                    <div class="h-link nursing-tracker" onclick="toggleTracker('nursingTracker', event)">متابعة الرضاعة</div>
                    
                    <div class="h-link activity-h-link" onclick="toggleTracker('exerciseTracker', event)">الرياضة</div>
                    <div class="h-link activity-h-link" onclick="toggleTracker('dietTracker', event)">التغذية</div>
                    <div class="h-link activity-h-link" onclick="toggleTracker('sleepTracker', event)">النوم</div>
                    <div class="h-link activity-h-link" onclick="toggleTracker('waterTracker', event)">شرب الماء</div>
                    
                    <div class="h-link skin-care-tracker" onclick="toggleTracker('skinCareTracker', event)">العناية بالبشرة</div>
                    <div class="h-link activity-h-link" onclick="toggleTracker('moodTracker', event)">متابعة الحالة المزاجية</div>
                    <div class="h-link activity-h-link" onclick="toggleTracker('supplementsTracker', event)">متابعة الفيتامينات</div>
                </div>
                
                <div class="tracker-ui" id="cycleTracker">
                    <form class="tracker-form" onsubmit="logCycleActivity(event)">
                        <label for="cycleDate">تاريخ أول يوم من آخر دورة:</label>
                        <input type="date" id="cycleDate" required>
                        <button type="submit" style="background: #e91e63;"><i class="fas fa-tint"></i> تتبع الدورة</button>
                    </form>
                    <div class="tracker-result" id="cycleResult" style="display: none; background: #ffe0e9; color: #e91e63;"></div>
                </div>

                <div class="tracker-ui" id="pregnancyTracker">
                    <form class="tracker-form" onsubmit="logPregnancyActivity(event)">
                        <label for="lastPeriodDate">تاريخ أول يوم لآخر دورة شهرية:</label>
                        <input type="date" id="lastPeriodDate" required>
                        <button type="submit" style="background: #ab47bc;"><i class="fas fa-baby"></i> حساب الحمل</button>
                    </form>
                    <div class="tracker-result" id="pregnancyResult" style="display: none; background: #f3e5f5; color: #7b1fa2;"></div>
                </div>
                
                <div class="tracker-ui" id="nursingTracker">
                    <form class="tracker-form" onsubmit="logNursingActivity(event)">
                        <label for="nursingType">نوع الإرضاع:</label>
                        <select id="nursingType" required>
                            <option value="الصدر الأيمن">الصدر الأيمن</option>
                            <option value="الصدر الأيسر">الصدر الأيسر</option>
                            <option value="صناعي/زجاجة">صناعي/زجاجة</option>
                        </select>
                        <label for="nursingDuration">المدة (دقائق):</label>
                        <input type="number" id="nursingDuration" value="15" min="1" required>
                        <label for="nursingTime">وقت البدء:</label>
                        <input type="time" id="nursingTime" required>
                        <button type="submit" style="background: var(--accent-green);"><i class="fas fa-check"></i> سجل رضاعة</button>
                    </form>
                    <h5 style="color: #666; margin-top: 20px; border-top: 1px solid #eee; padding-top: 10px;">آخر السجلات:</h5>
                    <div id="nursingLogDisplay">
                        <p style="text-align: center; color: #999; font-size: 0.85rem;">لا يوجد سجلات رضاعة حالياً.</p>
                    </div>
                </div>
                
                <div class="tracker-ui" id="exerciseTracker">
                    <form class="tracker-form" onsubmit="logExerciseActivity(event)">
                        <label for="exerciseType">نوع التمرين:</label>
                        <input type="text" id="exerciseType" placeholder="مثل: يوغا، مشي سريع" required>
                        <label for="exerciseDuration">المدة (دقائق):</label>
                        <input type="number" id="exerciseDuration" value="30" min="5" required>
                        <button type="submit" style="background: var(--accent-blue);"><i class="fas fa-check"></i> سجل تمرين</button>
                    </form>
                    <div class="tracker-result" id="exerciseResult" style="display: none; background: #e3f2fd; color: var(--accent-blue);"></div>
                </div>
                
                <div class="tracker-ui" id="waterTracker">
                    <form class="tracker-form" onsubmit="logWaterActivity(event)">
                        <label for="waterDate">تاريخ المتابعة:</label>
                        <input type="date" id="waterDate" required>
                        <label for="waterAmount">الكمية اليومية المتناولة (لتر):</label>
                        <input type="number" id="waterAmount" value="2" min="0.5" step="0.5" required>
                        <button type="submit" style="background: var(--accent-blue);"><i class="fas fa-check"></i> سجل شرب الماء</button>
                    </form>
                    <div class="tracker-result" id="waterResult" style="display: none; background: #e3f2fd; color: var(--accent-blue);"></div>
                </div>

                <div class="tracker-ui" id="sleepTracker">
                    <form class="tracker-form" onsubmit="logSleepActivity(event)">
                        <label for="sleepDate">تاريخ النوم:</label>
                        <input type="date" id="sleepDate" required>
                        <label for="sleepHours">عدد ساعات النوم:</label>
                        <input type="number" id="sleepHours" value="7" min="3" max="12" step="0.5" required>
                        <button type="submit" style="background: var(--accent-blue);"><i class="fas fa-check"></i> سجل جودة النوم</button>
                    </form>
                    <div class="tracker-result" id="sleepResult" style="display: none; background: #e3f2fd; color: var(--accent-blue);"></div>
                </div>

                <div class="tracker-ui" id="dietTracker">
                    <form class="tracker-form" onsubmit="logDietActivity(event)">
                        <label for="dietDate">تاريخ المتابعة:</label>
                        <input type="date" id="dietDate" required>
                        <label for="mealType">الوجبة:</label>
                        <select id="mealType" required>
                            <option value="فطور">فطور</option>
                            <option value="غداء">غداء</option>
                            <option value="عشاء">عشاء</option>
                            <option value="وجبة خفيفة">وجبة خفيفة</option>
                        </select>
                        <label for="dietNotes">ملاحظات/قائمة المأكولات:</label>
                        <textarea id="dietNotes" rows="3" placeholder="مثل: صدر دجاج، خضار مشوية، كوب زبادي" required></textarea>
                        <button type="submit" style="background: var(--accent-blue);"><i class="fas fa-check"></i> سجل وجبة</button>
                    </form>
                    <div class="tracker-result" id="dietResult" style="display: none; background: #e3f2fd; color: var(--accent-blue);"></div>
                </div>
                
                <div class="tracker-ui" id="skinCareTracker">
                    <form class="tracker-form" onsubmit="logSkinCareActivity(event)">
                        <label for="skinCareType">نوع الروتين:</label>
                        <select id="skinCareType" required>
                            <option value="روتين صباحي كامل">روتين صباحي كامل</option>
                            <option value="روتين مسائي كامل">روتين مسائي كامل</option>
                            <option value="ماسك/علاج خاص">ماسك/علاج خاص</option>
                        </select>
                        <label for="skinCareNotes">ملاحظات (المنتجات المستخدمة):</label>
                        <textarea id="skinCareNotes" rows="2" placeholder="مثال: فيتامين سي، مرطب حمض الهيالورونيك"></textarea>
                        <button type="submit" style="background: #ff80ab;"><i class="fas fa-check"></i> سجل روتين</button>
                    </form>
                    <div class="tracker-result" id="skinCareResult" style="display: none; background: #fce4ec; color: #ff80ab;"></div>
                </div>

                <div class="tracker-ui" id="moodTracker">
                    <form class="tracker-form" onsubmit="logMoodActivity(event)">
                        <label for="moodDate">تاريخ المتابعة:</label>
                        <input type="date" id="moodDate" required>
                        <label for="moodLevel">مستوى الحالة المزاجية (1=سيئ، 5=ممتاز):</label>
                        <input type="range" id="moodLevel" min="1" max="5" value="3" oninput="this.nextElementSibling.value=this.value">
                        <output>3</output>
                        <label for="moodNotes">ملاحظات سريعة:</label>
                        <textarea id="moodNotes" rows="2" placeholder="ما هي العوامل المؤثرة اليوم؟"></textarea>
                        <button type="submit" style="background: #673ab7;"><i class="fas fa-check"></i> سجل الحالة المزاجية</button>
                    </form>
                    <div class="tracker-result" id="moodResult" style="display: none; background: #ede7f6; color: #673ab7;"></div>
                </div>

                <div class="tracker-ui" id="supplementsTracker">
                    <form class="tracker-form" onsubmit="logSupplementsActivity(event)">
                        <label for="supplementsDate">تاريخ المتابعة:</label>
                        <input type="date" id="supplementsDate" required>
                        <label for="supplementName">اسم الفيتامين/المكمل:</label>
                        <input type="text" id="supplementName" placeholder="مثل: فيتامين د، حمض الفوليك" required>
                        <label for="supplementDose">الجرعة:</label>
                        <input type="text" id="supplementDose" placeholder="مثال: 1000 وحدة دولية">
                        <button type="submit" style="background: #009688;"><i class="fas fa-check"></i> سجل الجرعة</button>
                    </form>
                    <div class="tracker-result" id="supplementsResult" style="display: none; background: #e0f2f1; color: #009688;"></div>
                </div>
                
                <div class="sequential-content-container" id="content-container-sec-health">
                    <p style="text-align: center; color: #999; font-size: 0.85rem; margin-bottom: 0;">جاري تحميل المحتوى من قاعدة بيانات Neon...</p>
                </div>
                <div class="interaction-bar">
                    <button class="act-btn like-btn" onclick="toggleLike(this, 105)"><i class="far fa-heart"></i> <span>إعجاب</span></button>
                    <button class="act-btn" onclick="openCommentModal(105)"><i class="far fa-comment"></i> <span>تعليق</span></button>
                    <button class="act-btn" onclick="shareContent(105, 'الصحة والجمال')"><i class="fas fa-share-alt"></i> <span>مشاركة</span></button>
                </div>
            </div>
        </div>

        <div id="sec-society-new" class="section-view">
            <div class="card" data-post-id="104" data-post-title="المجتمع والتنمية">
                 <button class="delete-overlay-btn" onclick="deletePost('104', 'sec-society-new', event)"><i class="fas fa-times"></i></button>
                <div class="card-header"><i class="fas fa-users"></i> المجتمع والتنمية</div>
                <div class="bouh-display" id="txt-society-new" onclick="openContentScreen('sec-society-new', 'همسة الأسبوع', event)">
                    دورك الفعّال في تنمية مجتمعك، وقصص نجاح لملهمات.
                    <br> <small style="color:var(--primary-pink); display:block; margin-top:5px; text-align:center; font-weight:bold;"><i class="fas fa-search"></i> انقري هنا لقراءة الهمسة الأسبوعية</small> 
                </div>
                <a href="https://ar.wikipedia.org/wiki/%D8%AA%D9%86%D9%85%D9%8A%D8%A9_%D8%A8%D8%B4%D8%B1%D9%8A%D8%A9" target="_blank" class="library-link" title="مقالات وكتب عن المجتمع">مكتبة التنمية المجتمعية</a>
                <div class="sequential-content-container" id="content-container-sec-society-new">
                    <p style="text-align: center; color: #999; font-size: 0.85rem; margin-bottom: 0;">جاري تحميل المحتوى من قاعدة بيانات Neon...</p>
                </div>
                <div class="interaction-bar">
                    <button class="act-btn like-btn" onclick="toggleLike(this, 104)"><i class="far fa-heart"></i> <span>إعجاب</span></button>
                    <button class="act-btn" onclick="openCommentModal(104)"><i class="far fa-comment"></i> <span>تعليق</span></button>
                    <button class="act-btn" onclick="shareContent(104, 'المجتمع والتنمية')"><i class="fas fa-share-alt"></i> <span>مشاركة</span></button>
                </div>
            </div>
        </div>

    </div> <nav class="bottom-nav">
        <a href="#" class="nav-item active" data-section="home" onclick="navigate('home', this)"><i class="fas fa-home"></i> الرئيسية</a>
        <a href="#" class="nav-item" data-section="feelings" onclick="navigate('feelings', this)"><i class="fas fa-heart"></i> المشاعر</a>
        <a href="#" class="nav-item" data-section="fiqh" onclick="navigate('fiqh', this)"><i class="fas fa-book-reader"></i> الفقة</a>
        <a href="#" class="nav-item" data-section="intimacy-new" onclick="navigate('intimacy-new', this)"><i class="fas fa-hand-holding-heart"></i> الحميمية</a>
        <a href="#" class="nav-item" data-section="health" onclick="navigate('health', this)"><i class="fas fa-venus"></i> الصحة</a>
        <a href="#" class="nav-item" data-section="society-new" onclick="navigate('society-new', this)"><i class="fas fa-users"></i> المجتمع</a>
    </nav>


    <div class="modal-overlay" id="contentScreenModal">
        <div class="modal-box" style="max-width: 600px;">
            <h3 id="contentScreenTitle" style="color: var(--primary-pink);"><i class="fas fa-book-open"></i> تفاصيل المحتوى</h3>
            <div id="contentScreenBody" style="min-height: 100px; border: 1px solid #eee; padding: 15px; border-radius: 10px; background: #fafafa;"></div>
            <button type="button" class="btn-primary" onclick="closeModal('contentScreenModal')" style="background: var(--primary-pink); margin-top: 15px;">إغلاق</button>
        </div>
    </div>

    <div class="modal-overlay" id="commentModal">
        <div class="modal-box">
            <h3 style="color: var(--accent-green);"><i class="far fa-comment"></i> إضافة تعليق</h3>
            <p id="commentPostTitle" style="font-size: 0.9rem; color: #555; margin-bottom: 20px;"></p>
            <form onsubmit="submitComment(event)">
                <input type="hidden" id="commentPostId">
                <textarea id="commentText" class="inp-field" placeholder="اكتبي تعليقك هنا..." rows="4" required></textarea>
                <button type="submit" class="btn-primary" style="background: var(--accent-green);"><i class="fas fa-paper-plane"></i> إرسال</button>
                <button type="button" class="btn-primary" onclick="closeModal('commentModal')" style="background: #999; margin-top: 10px;">إلغاء</button>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="uploadPostModal">
        <div class="modal-box">
            <h3 id="uploadModalTitle" style="color: var(--primary-pink);"><i class="fas fa-upload"></i> رفع محتوى</h3>
            <form onsubmit="submitNewPost(event)">
                <input type="hidden" id="uploadPostType">
                <label for="postContent" style="display: block; margin-bottom: 10px; font-weight: bold;">محتوى المنشور:</label>
                <textarea id="postContent" class="inp-field" rows="8" placeholder="اكتب المحتوى الجديد هنا..." required></textarea>
                <button type="submit" class="btn-primary"><i class="fas fa-upload"></i> نشر الآن</button>
            </form>
        </div>
    </div>
    
    <div class="modal-overlay" id="aiGeneratorModal">
        <div class="modal-box" style="max-width: 600px;">
            <h3 style="color: #00bcd4;"><i class="fas fa-robot"></i> مولد المحتوى بالذكاء الاصطناعي</h3>
            <p style="font-size: 0.9rem; color: #777;">اكتب فكرة أو موضوعاً وسيقوم الذكاء الاصطناعي بتوليد مسودة.</p>
            
            <label for="aiPrompt" style="display: block; margin-top: 15px; margin-bottom: 10px; font-weight: bold;">الفكرة الرئيسية:</label>
            <textarea id="aiPrompt" class="inp-field" rows="3" placeholder="مثال: أهمية التنفس العميق في تخفيف القلق" required></textarea>
            
            <div class="ai-options">
                <div class="ai-option-btn active" data-type="بوست/منشور" onclick="selectAIType(this)">بوست</div>
                <div class="ai-option-btn" data-type="نصيحة" onclick="selectAIType(this)">نصيحة</div>
                <div class="ai-option-btn" data-type="البوح" onclick="selectAIType(this)">همسة أسبوعية</div>
            </div>
            
            <button class="btn-primary" onclick="generateAIContent(event)" style="background: #00bcd4;">
                <i class="fas fa-magic"></i> توليد
            </button>
            
            <div class="ai-output-container" id="aiOutput">
                <p style="text-align: center; color: #999;">سيظهر المحتوى المولّد هنا...</p>
            </div>
            
            <button class="btn-primary" id="useAIBtn" data-content="" onclick="useAIContent()" disabled style="background: var(--accent-green);">
                <i class="fas fa-check-circle"></i> استخدام المحتوى
            </button>
            
            <button type="button" class="btn-primary" onclick="closeModal('aiGeneratorModal')" style="background: #999; margin-top: 10px;">إلغاء/إغلاق</button>
        </div>
    </div>


    <script>
        // ==========================================================
        // معلومات تسجيل دخول المشرف (Admin Credentials)
        // تم الحفاظ عليها كما طلبت
        // ==========================================================
        const ADMIN_USERNAME = 'zazo';
        const ADMIN_PASSWORD = 'zazo010988'; 
        let isAdminLoggedIn = false;
        let isDeleteMode = false; 

        // ==========================================================
        // نقاط نهاية Vercel API (يجب استبدالها بنقاط النهاية الفعلية لـ Neon DB)
        // تم الحفاظ عليها كما طلبت
        // ==========================================================
        const API_GET_POSTS    = 'YOUR_VERCEL_API_ENDPOINT_FOR_GETTING_ALL_POSTS'; 
        const API_SAVE_POST    = 'YOUR_VERCEL_API_ENDPOINT_FOR_SAVING_NEW_POST';  
        const API_DELETE_POST  = 'YOUR_VERCEL_API_ENDPOINT_FOR_DELETING_POST'; // نقطة نهاية الحذف
        const API_AI_GENERATE  = 'YOUR_VERCEL_API_ENDPOINT_FOR_AI_GENERATOR'; 
        
        // ==========================================================
        // تعريفات العناصر والمحتويات
        // ==========================================================
        const contentContainers = {
            'sec-feelings': document.getElementById('content-container-sec-feelings'),
            'sec-fiqh': document.getElementById('content-container-sec-fiqh'),
            'sec-intimacy-new': document.getElementById('content-container-sec-intimacy-new'),
            'sec-health': document.getElementById('content-container-sec-health'),
            'sec-society-new': document.getElementById('content-container-sec-society-new')
        };
        
        const bouhDisplays = {
            'sec-feelings': document.getElementById('txt-feelings'),
            'sec-fiqh': document.getElementById('txt-fiqh'),
            'sec-intimacy-new': document.getElementById('txt-intimacy-new'),
            'sec-health': document.getElementById('txt-health'),
            'sec-society-new': document.getElementById('txt-society-new')
        };

        let savedContent = {}; 

        // ==========================================================
        // دوال الاتصال بقاعدة البيانات (Neon DB via Vercel API) - تم الحفاظ عليها
        // ==========================================================

        /**
         * دالة لجلب البيانات من Neon عند بدء التشغيل وتحديثها دورياً
         */
        async function fetchFromNeonDB() {
            console.log('جاري جلب المحتوى من Vercel API...');
            try {
                const response = await fetch(API_GET_POSTS);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();

                const fetchedPosts = data.posts || [];
                const newSavedContent = {};
                
                Object.keys(contentContainers).forEach(key => newSavedContent[key] = []);

                fetchedPosts.forEach(post => {
                    const sectionKey = post.section; 
                    if (newSavedContent.hasOwnProperty(sectionKey)) {
                        newSavedContent[sectionKey].push({
                            id: post.id, 
                            content: post.content,
                            section: post.section,
                            type: post.type,
                            date: new Date(post.created_at).toLocaleDateString('ar-EG', { day: '2-digit', month: '2-digit', year: 'numeric' })
                        });
                    }
                });

                savedContent = newSavedContent;
                console.log('تم جلب المحتوى بنجاح:', savedContent);

                // 3. تحديث الواجهة
                Object.keys(savedContent).forEach(sectionKey => {
                    const posts = savedContent[sectionKey].sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    const bouhPost = posts.find(p => p.type === 'البوح');
                    const defaultBouhContent = bouhDisplays[sectionKey].getAttribute('data-default-content') || 'محتوى افتراضي';

                    updateBouhDisplay(sectionKey, bouhPost ? bouhPost.content : defaultBouhContent, bouhPost ? bouhPost.id : null);
                    renderSequentialContent(sectionKey, posts);
                });

            } catch (error) {
                console.error('Error fetching from Neon/Vercel API:', error);
                Object.keys(contentContainers).forEach(sec => {
                    if (contentContainers[sec]) {
                        contentContainers[sec].innerHTML = '<p style="text-align: center; color: var(--accent-red); font-size: 0.9rem;">❌ فشل في جلب المحتوى. يرجى مراجعة اتصال API.</p>';
                    }
                });
            }
        }

        /**
         * دالة لحفظ المحتوى الجديد في Neon DB (لا تحذف المحتوى القديم)
         */
        async function saveToNeonDB(section, postData) {
            postData.created_at = new Date().toISOString(); 
            
            try {
                const response = await fetch(API_SAVE_POST, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(postData),
                });
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                await fetchFromNeonDB(); 
                return true;
            } catch (error) {
                console.error('Error saving to Neon/Vercel API:', error);
                alert('❌ فشل في نشر المحتوى. يرجى التأكد من عمل Vercel API بشكل صحيح: ' + error.message);
                return false;
            }
        }

        /**
         * دالة لحذف محتوى محدد من Neon DB والواجهة (مطلوب)
         */
        async function deletePost(postId, sectionKey, event) {
            event.stopPropagation(); 
            if (!isAdminLoggedIn || !isDeleteMode || !confirm(`هل أنت متأكد من حذف هذا المحتوى ذي المعرّف ${postId} من قسم ${sectionKey}؟ سيتم حذفه من قاعدة بيانات Neon بشكل دائم.`)) {
                return;
            }
            try {
                // إرسال طلب DELETE إلى نقطة النهاية المخصصة للحذف
                const response = await fetch(API_DELETE_POST + `?id=${postId}`, { 
                    method: 'DELETE',
                });
                if (response.ok) {
                    alert('✅ تم حذف المحتوى بنجاح من الواجهة وقاعدة بيانات Neon!');
                    await fetchFromNeonDB(); // تحديث الواجهة بعد الحذف
                    toggleDeleteMode(); // إلغاء وضع الحذف تلقائياً
                } else {
                    alert('❌ فشل في إرسال طلب الحذف إلى Vercel API. تحقق من الباك إند.');
                }
            } catch (error) {
                console.error('Error deleting post:', error);
                alert('❌ حدث خطأ في الاتصال أثناء محاولة الحذف.');
            }
        }

        // ==========================================================
        // دوال التنقل و الإدارة
        // ==========================================================
        
        /**
         * دالة التنقل بين الأقسام وتحديث شريط التنقل السفلي
         */
        function navigate(sectionId, element) {
            // إظهار القسم المطلوب
            showSection(sectionId);
            
            // إزالة حالة التفعيل من جميع الأزرار
            document.querySelectorAll('.nav-item').forEach(navItem => {
                navItem.classList.remove('active');
            });

            // إضافة حالة التفعيل للزر الذي تم النقر عليه
            if (element) {
                element.classList.add('active');
            }
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section-view').forEach(view => {
                view.style.display = 'none';
            });
            const sectionView = document.getElementById(sectionId + 'View') || document.getElementById('sec-' + sectionId);
            if (sectionView) {
                sectionView.style.display = 'block';
            }
            // إخفاء لوحة الأدمن عند التنقل
            document.getElementById('adminLogin').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'none';
        }

        function toggleAdminPanel() {
            const loginPanel = document.getElementById('adminLogin');
            const dashboardPanel = document.getElementById('adminDashboard');
            
            // إخفاء الأقسام عند فتح لوحة التحكم
            document.querySelectorAll('.section-view').forEach(view => { view.style.display = 'none'; });
            
            if (!isAdminLoggedIn) {
                loginPanel.style.display = (loginPanel.style.display === 'block') ? 'none' : 'block';
                dashboardPanel.style.display = 'none';
            } else {
                dashboardPanel.style.display = (dashboardPanel.style.display === 'block') ? 'none' : 'block';
                loginPanel.style.display = 'none';
            }
        }
        
        function adminLogin(event) {
            event.preventDefault();
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;

            if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                isAdminLoggedIn = true;
                document.getElementById('adminLogin').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                document.getElementById('adminToggleBtn').style.background = '#00c853'; 
                alert('تم تسجيل الدخول بنجاح! مرحباً بك يا Zazo.');
                document.body.classList.remove('delete-mode-active'); 
            } else {
                alert('فشل تسجيل الدخول. يرجى التحقق من اسم المستخدم وكلمة المرور.');
            }
        }

        function toggleDeleteMode() {
            if (!isAdminLoggedIn) return;
            isDeleteMode = !isDeleteMode;
            document.body.classList.toggle('delete-mode-active', isDeleteMode);
            const btn = document.getElementById('deleteModeBtn');
            if (isDeleteMode) {
                btn.innerHTML = '<i class="fas fa-trash-undo"></i> إلغاء وضع الحذف';
                btn.style.background = '#ff9800'; 
                alert('تفعيل وضع الحذف! انقر على أي محتوى لحذفه بشكل دائم من قاعدة البيانات.');
            } else {
                btn.innerHTML = '<i class="fas fa-trash-alt"></i> تفعيل وضع الحذف';
                btn.style.background = '#f44336'; 
                if(document.getElementById('adminDashboard').style.display === 'none') {
                    document.body.classList.remove('delete-mode-active');
                }
                alert('إلغاء وضع الحذف.');
            }
        }

        function openUploadPostModal(type) {
            if (!isAdminLoggedIn) {
                alert('يجب تسجيل الدخول كمسؤول أولاً.');
                return;
            }
            document.getElementById('uploadModalTitle').innerHTML = `<i class="fas fa-upload"></i> رفع محتوى (${type})`;
            document.getElementById('uploadPostType').value = type;
            document.getElementById('postContent').value = '';
            closeModal('aiGeneratorModal');
            openModal('uploadPostModal');
        }

        async function submitNewPost(event) {
            event.preventDefault();
            const content = document.getElementById('postContent').value;
            const type = document.getElementById('uploadPostType').value;
            const section = document.getElementById('adminSectionSelect').value;

            if (!content || !type || !section) return;

            const newPost = {
                section: section,
                type: type,
                content: content,
            };

            const success = await saveToNeonDB(section, newPost); 
            if (success) {
                closeModal('uploadPostModal');
                alert(`تم رفع محتوى "${type}" إلى قسم "${section}" بنجاح! جاري التحديث.`);
            }
        }
        
        // (بقية دوال عرض المحتوى، Modals، والتتبعات تم الحفاظ عليها كما هي)
        
        function updateBouhDisplay(section, content, postId = null) {
            const bouhElement = bouhDisplays[section];
            if (bouhElement) {
                bouhElement.innerHTML = content + `<br><small style="color:var(--primary-pink); display:block; margin-top:5px; text-align:center; font-weight:bold;"><i class="fas fa-search"></i> انقري هنا لقراءة الهمسة الأسبوعية</small>`;
                
                const parentCard = bouhElement.closest('.card');
                if(parentCard && postId) {
                    parentCard.setAttribute('data-post-id', postId);
                    const deleteBtn = parentCard.querySelector('.delete-overlay-btn');
                    if(deleteBtn) {
                         deleteBtn.setAttribute('onclick', `deletePost('${postId}', '${section}', event)`);
                    }
                }
            }
        }

        function renderSequentialContent(section, posts) {
            const container = contentContainers[section];
            if (!container) return;
            
            const nonBouhPosts = posts.filter(p => p.type !== 'البوح');
            
            let html = '';
            if (nonBouhPosts.length === 0) {
                 html = '<p style="text-align: center; color: #999; font-size: 0.85rem; margin-bottom: 0;">لا يوجد محتوى حالياً في هذا القسم. انشري شيئاً جديداً!</p>';
            } else {
                nonBouhPosts.forEach((post, index) => {
                    const highlightClass = index === 0 ? 'newly-added' : '';
                    
                    html += `
                        <div class="content-item-card ${highlightClass}" data-post-id="${post.id}" data-content-type="${post.type}" onclick="openContentScreen('${section}', '${post.content.substring(0, 30)}...', event)">
                            <button class="delete-overlay-btn" onclick="deletePost('${post.id}', '${section}', event)"><i class="fas fa-times"></i></button>
                            <span class="type-badge">${post.type}</span>
                            <div class="post-content">${post.content.substring(0, 100)}...</div>
                            <small>تاريخ النشر: ${post.date}</small>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }

        function filterContent(searchTerm) {
            searchTerm = searchTerm.toLowerCase().trim();
            document.querySelectorAll('.section-view').forEach(view => {
                let hasMatch = false;
                view.querySelectorAll('.content-item-card, .bouh-display').forEach(item => {
                    let itemContent = item.innerText.toLowerCase() || "";
                    let isMatch = false;
                    
                    if (itemContent.includes(searchTerm)) {
                         isMatch = true;
                    }
                    if (item.classList.contains('content-item-card')) {
                         const itemType = item.getAttribute('data-content-type')?.toLowerCase() || "";
                         if(itemType.includes(searchTerm)) isMatch = true;
                    }

                    if (isMatch) {
                        item.style.display = 'block'; 
                        hasMatch = true;
                    } else {
                        item.style.display = 'none'; 
                    }
                });
                
                if (searchTerm === '' || hasMatch) {
                    view.style.display = 'block';
                } else {
                    view.style.display = 'none';
                }
            });

            document.querySelectorAll('.tracker-ui').forEach(tracker => {
                const trackerName = tracker.id.replace('Tracker', '').toLowerCase();
                if (searchTerm === '' || trackerName.includes(searchTerm)) {
                    if (searchTerm === '') {
                        // لا تفعل شيئاً، دعها مخفية/ظاهرة حسب الدالة toggleTracker
                    } else if (trackerName.includes(searchTerm)) {
                        tracker.style.display = 'block';
                    } else {
                        tracker.style.display = 'none';
                    }
                }
            });
            
             if(searchTerm === '') {
                document.querySelectorAll('.section-view').forEach(view => view.style.display = 'none');
                document.getElementById('homeView').style.display = 'block';
                // تحديث شريط التنقل لعرض القسم النشط (الرئيسية)
                document.querySelectorAll('.nav-item').forEach(navItem => navItem.classList.remove('active'));
                document.querySelector('.nav-item[data-section="home"]').classList.add('active');
            }
        }
        
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function openContentScreen(sectionId, title, event) {
             event.stopPropagation(); 
             if (isDeleteMode) return;

             const posts = savedContent[sectionId];
             const cardElement = event.currentTarget.closest('.card, .content-item-card');
             const postId = cardElement ? cardElement.getAttribute('data-post-id') : null;
             
             let fullContent = title;
             if (posts && postId) {
                 const post = posts.find(p => p.id == postId);
                 if (post) {
                     document.getElementById('contentScreenTitle').innerHTML = `<i class="fas fa-book-open"></i> ${post.type} - ${post.section.replace('sec-', '')}`;
                     fullContent = post.content;
                 }
             } else {
                 document.getElementById('contentScreenTitle').innerHTML = `<i class="fas fa-book-open"></i> ${title}`;
                 fullContent = cardElement.querySelector('.bouh-display')?.innerText.split('\n')[0] || title;
             }
             
             document.getElementById('contentScreenBody').innerText = fullContent;
             openModal('contentScreenModal');
        }

        function openCommentModal(postId) {
            if (isDeleteMode) return;
            document.getElementById('commentPostId').value = postId;
            const postElement = document.querySelector(`.card[data-post-id="${postId}"], .content-item-card[data-post-id="${postId}"]`);
            const postTitle = postElement ? postElement.getAttribute('data-post-title') || postElement.querySelector('.post-content')?.innerText.substring(0, 30) + '...' : 'محتوى غير معروف';
            document.getElementById('commentPostTitle').innerText = `للتعليق على: ${postTitle}`;
            openModal('commentModal');
        }

        function submitComment(event) {
            event.preventDefault();
            const postId = document.getElementById('commentPostId').value;
            closeModal('commentModal');
            alert('تم إرسال تعليقك بنجاح! (محاكاة)');
        }

        function toggleLike(btn, postId) {
            if (isDeleteMode) return;
            btn.classList.toggle('liked');
            let span = btn.querySelector('span');
            let currentLikes = parseInt(span.innerText.replace(' إعجاب', '').trim()) || 0;

            if (btn.classList.contains('liked')) {
                currentLikes += 1;
                btn.querySelector('i').classList.replace('far', 'fas');
            } else {
                currentLikes -= 1;
                btn.querySelector('i').classList.replace('fas', 'far');
            }
            span.innerText = ` ${currentLikes} إعجاب`;
        }

        function shareContent(postId, title) {
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: `شاركتك محتوى جديد من تطبيق "رقة": ${title}`,
                    url: window.location.href, 
                }).catch(error => console.log('Error sharing:', error));
            } else {
                alert(`يمكنك مشاركة المحتوى: ${title}\n(وظيفة المشاركة غير مدعومة في هذا المتصفح)`);
            }
        }
        
        // ** دوال الذكاء الاصطناعي (محاكاة) **
        function selectAIType(btn) {
            document.querySelectorAll('.ai-option-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        async function generateAIContent(event) {
            event.preventDefault();
            if (!isAdminLoggedIn) return alert('يجب تسجيل الدخول كمسؤول أولاً.');
            
            const prompt = document.getElementById('aiPrompt').value;
            const type = document.querySelector('.ai-option-btn.active').getAttribute('data-type');
            const outputElement = document.getElementById('aiOutput');
            const useBtn = document.getElementById('useAIBtn');
            
            outputElement.innerHTML = '<p style="text-align: center; color: #00bcd4;"><i class="fas fa-spinner fa-spin"></i> جاري توليد المحتوى...</p>';
            useBtn.disabled = true;

            let generatedText = `هذا محتوى مولد آلياً لنوع "${type}" بناءً على فكرة: "${prompt}". الهدف هو توفير مسودة أولية يمكنك تعديلها قبل النشر. (تم التوليد في: ${new Date().toLocaleTimeString()})`;
            
            await new Promise(resolve => setTimeout(resolve, 1500)); 

            startTypingEffect(generatedText, outputElement, useBtn);
        }

        function startTypingEffect(text, element, useBtn) {
            element.innerHTML = '<i class="fas fa-robot"></i> <span id="typingText"></span><span class="typing-cursor"></span>';
            const typingTextElement = document.getElementById('typingText');
            let i = 0;
            const speed = 15;
            function typeWriter() {
                if (i < text.length) {
                    typingTextElement.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(typeWriter, speed);
                } else {
                    document.querySelector('.typing-cursor').style.display = 'none';
                    useBtn.setAttribute('data-content', text);
                    useBtn.disabled = false;
                }
            }
            typeWriter();
        }

        function useAIContent() {
            const useBtn = document.getElementById('useAIBtn');
            const content = useBtn.getAttribute('data-content');
            const typeElement = document.querySelector('.ai-option-btn.active');
            const type = typeElement ? typeElement.getAttribute('data-type') : 'بوست/منشور';

            if (content) {
                openUploadPostModal(type);
                document.getElementById('postContent').value = content;
            }
        }
        
        // ** دوال التتبعات الصحية (تم الاحتفاظ بها) **
        function toggleTracker(trackerId, event) {
            event.preventDefault();
            const tracker = document.getElementById(trackerId);
            document.querySelectorAll('.tracker-ui').forEach(ui => {
                if (ui.id !== trackerId) ui.style.display = 'none';
            });
            tracker.style.display = (tracker.style.display === 'block') ? 'none' : 'block';
        }
        
        function logCycleActivity(event) {
            event.preventDefault();
            const date = document.getElementById('cycleDate').value;
            const resultDiv = document.getElementById('cycleResult');
            const lastPeriod = new Date(date);
            if (!date) return;
            const cycleDuration = 28; 
            const ovulationDay = 14; 
            const nextPeriod = new Date(lastPeriod.getTime() + cycleDuration * 24 * 60 * 60 * 1000);
            const ovulationDate = new Date(nextPeriod.getTime() - ovulationDay * 24 * 60 * 60 * 1000);

            resultDiv.innerHTML = `<i class="fas fa-calendar-alt"></i> **توقع الدورة التالية:** ${nextPeriod.toLocaleDateString('ar-EG')}<br> **فترة التبويض المتوقعة:** حوالي ${ovulationDate.toLocaleDateString('ar-EG')}`;
            resultDiv.style.display = 'block';
        }
        
        function logPregnancyActivity(event) {
            event.preventDefault();
            const date = document.getElementById('lastPeriodDate').value;
            const resultDiv = document.getElementById('pregnancyResult');
            const lastPeriod = new Date(date);
            if (!date) return;
            const dueDate = new Date(lastPeriod.getTime());
            dueDate.setDate(dueDate.getDate() + 7);
            dueDate.setMonth(dueDate.getMonth() - 3);
            dueDate.setFullYear(dueDate.getFullYear() + 1);

            const today = new Date();
            const elapsedDays = Math.ceil((today - lastPeriod) / (1000 * 60 * 60 * 24));
            const weeks = Math.floor(elapsedDays / 7);
            const remainingDays = elapsedDays % 7;
            const daysLeft = Math.ceil((dueDate - today) / (1000 * 60 * 60 * 24));

            if (weeks < 0 || weeks > 40) {
                 resultDiv.innerHTML = '<i class="fas fa-exclamation-triangle"></i> يرجى إدخال تاريخ صحيح للدورة الأخيرة.';
                 resultDiv.style.display = 'block';
                 return;
            }
            
            resultDiv.innerHTML = `<i class="fas fa-baby"></i> **تاريخ الولادة المتوقع:** ${dueDate.toLocaleDateString('ar-EG')}<br> **أنتِ الآن في الأسبوع:** ${weeks} ويوم ${remainingDays}<br> **المتبقي للولادة:** ${daysLeft} يوم تقريباً`;
            resultDiv.style.display = 'block';
        }

        let nursingLogs = JSON.parse(localStorage.getItem('nursingLogs')) || [];
        
        function logNursingActivity(event) {
            event.preventDefault();
            const type = document.getElementById('nursingType').value;
            const duration = document.getElementById('nursingDuration').value;
            const time = document.getElementById('nursingTime').value;
            
            const newLog = {
                id: Date.now(),
                type,
                duration,
                time
            };
            nursingLogs.unshift(newLog); 
            localStorage.setItem('nursingLogs', JSON.stringify(nursingLogs));
            displayNursingLogs();
            alert('تم تسجيل الرضاعة بنجاح!');
        }

        function deleteNursingLog(id, event) {
             event.stopPropagation();
             if (!confirm('هل أنت متأكد من حذف هذا السجل؟')) return;
             nursingLogs = nursingLogs.filter(log => log.id !== id);
             localStorage.setItem('nursingLogs', JSON.stringify(nursingLogs));
             displayNursingLogs();
        }

        function displayNursingLogs() {
            const container = document.getElementById('nursingLogDisplay');
            let html = '';
            
            if (nursingLogs.length === 0) {
                html = '<p style="text-align: center; color: #999; font-size: 0.85rem;">لا يوجد سجلات رضاعة حالياً.</p>';
            } else {
                nursingLogs.slice(0, 5).forEach(log => {
                    html += `<div class="nursing-log"><span>**${log.type}** (${log.duration} دقيقة) في: ${log.time}</span><button onclick="deleteNursingLog(${log.id}, event)"><i class="fas fa-times"></i> حذف</button></div>`;
                });
                if (nursingLogs.length > 5) {
                     html += `<p style="text-align: center; font-size: 0.8rem; color: #aaa; margin-top: 10px;">...و ${nursingLogs.length - 5} سجلات أخرى.</p>`;
                }
            }
            container.innerHTML = html;
        }

        function logExerciseActivity(event) {
            event.preventDefault();
            const type = document.getElementById('exerciseType').value;
            const duration = document.getElementById('exerciseDuration').value;
            const resultDiv = document.getElementById('exerciseResult');
            resultDiv.innerHTML = `<i class="fas fa-dumbbell"></i> أحسنت! تم تسجيل تمرين **${type}** لمدة **${duration} دقيقة** اليوم.`;
            resultDiv.style.display = 'block';
        }
        
        function logWaterActivity(event) {
            event.preventDefault();
            const amount = document.getElementById('waterAmount').value;
            const resultDiv = document.getElementById('waterResult');
            if (parseFloat(amount) >= 2) {
                 resultDiv.innerHTML = `<i class="fas fa-water"></i> ممتاز! تم تسجيل شرب **${amount} لتر** من الماء. استمري في الترطيب!`;
            } else {
                 resultDiv.innerHTML = `<i class="fas fa-tint-slash"></i> تم تسجيل شرب **${amount} لتر**. حاولي الوصول إلى 2 لتر على الأقل!`;
            }
            resultDiv.style.display = 'block';
        }

        function logSleepActivity(event) {
             event.preventDefault();
             const hours = parseFloat(document.getElementById('sleepHours').value);
             const resultDiv = document.getElementById('sleepResult');
             if (hours >= 7.5) {
                 resultDiv.innerHTML = `<i class="fas fa-moon"></i> نوم عميق! تم تسجيل **${hours} ساعة**.`;
             } else if (hours >= 6) {
                 resultDiv.innerHTML = `<i class="fas fa-bed"></i> نوم جيد. تم تسجيل **${hours} ساعة**.`;
             } else {
                 resultDiv.innerHTML = `<i class="fas fa-tired"></i> انتبهي! تم تسجيل **${hours} ساعة**. حاولي زيادة ساعات نومك.`;
             }
             resultDiv.style.display = 'block';
        }

        function logDietActivity(event) {
             event.preventDefault();
             const mealType = document.getElementById('mealType').value;
             const notes = document.getElementById('dietNotes').value;
             const resultDiv = document.getElementById('dietResult');
             resultDiv.innerHTML = `<i class="fas fa-utensils"></i> تم تسجيل وجبة **${mealType}** بنجاح. (${notes.substring(0, 50)}...)`;
             resultDiv.style.display = 'block';
        }

        function logSkinCareActivity(event) {
            event.preventDefault();
            const type = document.getElementById('skinCareType').value;
            const notes = document.getElementById('skinCareNotes').value;
            const resultDiv = document.getElementById('skinCareResult');
            
            resultDiv.innerHTML = `<i class="fas fa-spa"></i> تم تسجيل نشاط العناية بالبشرة بنجاح!<p style="margin: 5px 0 0 0; font-size: 0.85rem;">**الروتين:** ${type}</p>${notes ? `<p style="margin: 0; font-size: 0.85rem;">**ملاحظة:** ${notes}</p>` : ''}`;
            resultDiv.style.display = 'block';
        }
        
        function logMoodActivity(event) {
            event.preventDefault();
            const date = document.getElementById('moodDate').value;
            const level = document.getElementById('moodLevel').value;
            const notes = document.getElementById('moodNotes').value;
            const resultDiv = document.getElementById('moodResult');
            
            let moodText = '';
            if (level == 5) moodText = 'ممتاز ومشرق!';
            else if (level == 4) moodText = 'جيد ومستقر.';
            else if (level == 3) moodText = 'متوسط ومقبول.';
            else if (level == 2) moodText = 'أقل من المتوسط.';
            else moodText = 'سيئ، نتمنى لك الأفضل!';

            resultDiv.innerHTML = `<i class="fas fa-smile"></i> تم تسجيل حالتك المزاجية ليوم **${date}** بمستوى **${level}/5** (${moodText}) بنجاح!`;
            
            if (level >= 4) {
                 resultDiv.style.background = '#e8f5e9'; resultDiv.style.color = '#4CAF50';
            } else if (level == 3) {
                 resultDiv.style.background = '#fff3e0'; resultDiv.style.color = '#ff9800';
            } else {
                 resultDiv.style.background = '#ffebee'; resultDiv.style.color = '#f44336';
            }

            resultDiv.style.display = 'block';
        }

        function logSupplementsActivity(event) {
            event.preventDefault();
            const date = document.getElementById('supplementsDate').value;
            const name = document.getElementById('supplementName').value;
            const dose = document.getElementById('supplementDose').value;
            const resultDiv = document.getElementById('supplementsResult');
            
            resultDiv.innerHTML = `<i class="fas fa-pills"></i> تم تسجيل تناول **${name}** بجرعة **${dose}** في **${date}** بنجاح!`;
            resultDiv.style.display = 'block';
        }


        // ==========================================================
        // وظائف التهيئة والبدء (Initialization)
        // ==========================================================

        window.onload = function() {
            // 1. إضافة محتوى افتراضي لجميع الـ bouh-display للحفظ
            Object.keys(bouhDisplays).forEach(sec => {
                if(bouhDisplays[sec]) bouhDisplays[sec].setAttribute('data-default-content', bouhDisplays[sec].innerText.trim().split('\n')[0]);
            });
            
            // 2. جلب البيانات من Neon (عبر Vercel API)
            fetchFromNeonDB();
            
            // 3. عرض سجلات الرضاعة عند البدء
            displayNursingLogs(); 
        };
    </script>
</body>
</html>
